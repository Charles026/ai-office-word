# AI-LIBRE Â· Local AI Word Editor

<p align="center">
  <strong>A local-first, AI-native word processor powered by LibreOffice + modern web editor + DocAgent runtime.</strong>
</p>

<p align="center">
  <em>æœ¬åœ°ä¼˜å…ˆ Â· AI åŸç”Ÿ Â· docx å…¼å®¹</em>
</p>

---

AI-LIBRE æ˜¯ä¸€ä¸ª**æœ¬åœ°ä¼˜å…ˆçš„ AI æ–‡æ¡£ç¼–è¾‘å™¨**ï¼š

- åº•å±‚å¤ç”¨ LibreOffice çš„æ–‡æ¡£èƒ½åŠ›ï¼ˆå…¼å®¹ `.docx`ï¼‰
- å‰ç«¯é‡‡ç”¨ç°ä»£ç¼–è¾‘å™¨ï¼ˆLexicalï¼‰å’Œè‡ªå®šä¹‰ Ribbon UI
- é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„ **DocAgent Runtime** æŠŠã€Œç¿»è¯‘ã€æ”¹å†™ã€æ€»ç»“ã€ç­‰ AI èƒ½åŠ›çœŸæ­£åµŒå…¥å†™ä½œæµç¨‹

ç›®æ ‡ä¸æ˜¯å†åšä¸€ä¸ªåœ¨çº¿ååŒ Notionï¼Œè€Œæ˜¯åšä¸€æ¬¾ **ä¸ªäººæœ¬åœ° AI Word**ï¼š

- ğŸ“ æ–‡æ¡£éƒ½åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œéšæ—¶å¯ç”¨ `.docx` æ‰“å¼€
- ğŸŒ åªåœ¨éœ€è¦ AI æ—¶è”ç½‘è¯·æ±‚ï¼ˆé€šè¿‡ç¬¬ä¸‰æ–¹æ¨¡å‹ APIï¼Œä¾‹å¦‚ OpenRouterï¼‰
- âœ¨ åœ¨ã€Œå†™ä½œä½“éªŒ + AI èƒ½åŠ›ã€ä¸Šæ¯”ä¼ ç»Ÿ Office + Copilot æ›´é¡ºæ‰‹

> ğŸ“– **æ ¸å¿ƒæ–‡æ¡£**
> - [æ¶æ„è¯´æ˜ä¸é‡Œç¨‹ç¢‘](./docs/architecture-word-core-v1.md) - æ–‡æ¡£å†…æ ¸ v1 å®Œæ•´è¯´æ˜
> - [é‡Œç¨‹ç¢‘è¿½è¸ª](./docs/MILESTONES.md) - å½“å‰è¿›åº¦ä¸å¾…åŠäº‹é¡¹
> - [æ¶æ„è®¾è®¡](./docs/ARCHITECTURE.md) - ç³»ç»Ÿæ¶æ„å›¾

---

## Core Value / æ ¸å¿ƒä»·å€¼

### 1. æœ¬åœ°ä¼˜å…ˆï¼Œdocx å…¼å®¹

- æ–‡æ¡£ä»¥ `.docx` ä¿å­˜åœ¨æœ¬åœ°ç›®å½•
- æ”¯æŒæ‰“å¼€ / ç¼–è¾‘ / è‡ªåŠ¨ä¿å­˜ / å¿«ç…§å›æ»š
- å‡ºé—®é¢˜æ—¶ï¼Œè‡³å°‘ä¸ä¼šã€Œç¨¿å­æ²¡äº†ã€

### 2. AI-native å†™ä½œä½“éªŒ

- **é€‰åŒºçº§ AI**ï¼šæ”¹å†™ã€ç¿»è¯‘ã€æ€»ç»“ã€æ‰©å†™ï¼Œä¿ç•™åŸæœ‰æ ¼å¼
- **å¤§çº²çº§ AI**ï¼šå¯¹æŸä¸€èŠ‚ç”Ÿæˆæ‘˜è¦ã€é£æ ¼å˜ä½“ï¼Œè‡ªåŠ¨æ’å…¥åˆ°æ–‡æ¡£æŒ‡å®šä½ç½®
- æ‰€æœ‰ AI è¡Œä¸ºéƒ½å›´ç»•ã€Œå†™ä½œã€è®¾è®¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæµ®åœ¨ä¸Šé¢çš„èŠå¤©çª—

### 3. DocAgent Runtime ç»Ÿä¸€è°ƒåº¦

- æ–‡æœ¬é€‰åŒº / å°èŠ‚ / å…¨æ–‡ â†’ ç»“æ„åŒ–è¯·æ±‚ â†’ æ¨¡å‹å“åº” â†’ æ–‡æ¡£ AST å›å†™
- æ”¯æŒçŠ¶æ€ç®¡ç†ã€å¯å–æ¶ˆã€é”™è¯¯æç¤ºã€æ—¥å¿—è®°å½•
- åç»­è¦å¢åŠ æ–°çš„ Agentï¼ˆä¾‹å¦‚"ç”Ÿæˆç›®å½•""æ¶¦è‰²å…¨ç¯‡"ï¼‰åªéœ€è¦ï¼š
  - å†™ä¸€ä¸ª handler
  - åŠ ä¸€ä¸ª UI å…¥å£ï¼ˆæŒ‰é’® / èœå•é¡¹ï¼‰

---

## Current Status / å½“å‰è¿›å±•ï¼ˆv0ï¼‰

### ğŸ¨ Shell & Layout

- è‡ªå®šä¹‰çª—å£ Shell + Liquid Glass é£æ ¼ç•Œé¢ï¼ˆmacOS é£æ ¼ï¼‰
- å·¦ä¾§ä¸ºå¯¼èˆªï¼š`æ–°å»º / æ‰“å¼€ / æ–‡æ¡£` + æœ€è¿‘æ–‡æ¡£åˆ—è¡¨ï¼ˆçºµå‘ tabï¼‰
- ä¸­é—´ä¸ºç¼–è¾‘ç”»å¸ƒï¼Œé¡¶éƒ¨ä¸ºç®€åŒ–ç‰ˆ Ribbon

### âœï¸ ç¼–è¾‘èƒ½åŠ›

- åŸºç¡€æ–‡æœ¬ç¼–è¾‘ï¼ˆè¾“å…¥ã€å…‰æ ‡ã€æ’¤é”€ / é‡åšï¼‰
- å­—ä½“å­—å·ã€ç²—ä½“ / æ–œä½“ / ä¸‹åˆ’çº¿ã€æ ‡é¢˜çº§åˆ«ï¼ˆH1/H2/H3ï¼‰
- æ®µè½å¯¹é½ï¼ˆå·¦ / ä¸­ / å³ï¼‰ã€æœ‰åº / æ— åºåˆ—è¡¨
- è‡ªåŠ¨ä¿å­˜ + æ‰‹åŠ¨ä¿å­˜ï¼ˆå†™å›åŒä¸€ä¸ª `.docx` æ–‡ä»¶ï¼‰
- æœ€è¿‘æ–‡æ¡£åˆ—è¡¨ + å´©æºƒæ¢å¤ï¼ˆåŸºäº `recentDocuments.json` + å¿«ç…§ç›®å½•ï¼‰

### ğŸ§  AI èƒ½åŠ›ï¼ˆDocAgent v0ï¼‰

**é€‰åŒºçº§ï¼š**
- æ”¹å†™ï¼ˆå¤šç§é£æ ¼ï¼šæ›´æ­£å¼ / æ›´ç®€æ´ / æ›´å‹å¥½ç­‰ï¼‰
- ä¸­è‹±äº’è¯‘
- æ€»ç»“å½“å‰é€‰åŒº

**å¤§çº²çº§ï¼š**
- è‡ªåŠ¨è¯†åˆ« H1/H2/H3 ç”Ÿæˆã€Œå¤§çº²è§†å›¾ã€
- é’ˆå¯¹æŸä¸€å°èŠ‚è¿›è¡Œï¼šæ€»ç»“ / å˜æ­£å¼ / å˜ç®€æ´ / ç¿»è¯‘ï¼Œå¹¶æ’å…¥ç»“å°¾æ€»ç»“æ®µ
- æ•´ç¯‡æ–‡æ¡£ç¿»è¯‘ï¼ˆä¿ç•™æ ¼å¼ï¼‰

**ç»Ÿä¸€ Runtimeï¼š**
- æ”¯æŒ `pending â†’ running â†’ success / error` çŠ¶æ€
- æ”¯æŒé”™è¯¯ toast + æ—¥å¿—ï¼ˆä¾¿äºåç»­è°ƒè¯•å’Œç›‘æ§ï¼‰
- å¯å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ AI ä»»åŠ¡

---

## Architecture Overview / æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è§†å›¾å±‚ (Views)                           â”‚
â”‚   NewDocView â”‚ DocumentManagerView â”‚ OutlinePane â”‚ Editor       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      çŠ¶æ€ç®¡ç† (AppContext)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   EditorContainer              â”‚        DocOps Engine           â”‚
â”‚   (å‘½ä»¤å¤„ç† + Selection)        â”‚     (AI Intent â†’ DocOps)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Canvas (Lexical æ¸²æŸ“ + ç¼–è¾‘)  â”‚       Document Engine          â”‚
â”‚                                â”‚     (DocOps â†’ AST æ›´æ–°)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚    Format/Layout Engine        â”‚
â”‚                                â”‚   (docx â†” HTML â†” AST)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚       AI Runtime               â”‚
â”‚                                â”‚   DocAgent + LlmService        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—

| æ¨¡å— | èŒè´£ |
|------|------|
| **docEngine/** | `LibreOfficeEngine` / `SimpleDocxEngine`ï¼Œè´Ÿè´£ `.docx` çš„åŠ è½½ / ä¿å­˜ / ä¸ç¼–è¾‘å™¨ä¹‹é—´çš„æ•°æ®è½¬æ¢ |
| **format/** | å®šä¹‰ **docx â†” HTML â†” Editor AST** çš„æ˜ å°„è§„åˆ™ï¼Œæä¾›æ ¼å¼åŒ–ã€æ®µè½/æ ‡é¢˜/åˆ—è¡¨ç­‰ç»“æ„çš„è§£æä¸è¾“å‡º |
| **editor/** | åŸºäº Lexical å®ç°çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè´Ÿè´£å…‰æ ‡è¡Œä¸ºã€é”®ç›˜äº‹ä»¶ã€é€‰åŒºç®¡ç† |
| **docops/** | æŠŠç”¨æˆ·æ“ä½œ / AI æŒ‡ä»¤è½¬æˆå…·ä½“çš„æ–‡æ¡£å˜æ›´ï¼ˆæ’å…¥ã€æ›¿æ¢ã€åŒ…è£¹æ®µè½ç­‰ï¼‰ |
| **runtime/** | DocAgent Runtime æ ¸å¿ƒï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚ã€ç»„ç»‡ä¸Šä¸‹æ–‡ã€è°ƒç”¨ LLMã€æ›´æ–°æ–‡æ¡£ AST |
| **outline/** | å¤§çº²è§†å›¾ï¼šåŸºäº AST çš„æ ‡é¢˜ç»“æ„ï¼Œæä¾›ã€Œç‚¹å‡»è·³è½¬ã€ã€Œå°èŠ‚çº§ AI èœå•ã€ç­‰èƒ½åŠ› |
| **core/** | æ ¸å¿ƒæœåŠ¡ï¼š`DocumentSaveService`ï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰ã€`SnapshotService`ï¼ˆç‰ˆæœ¬å¿«ç…§ï¼‰ |
| **ipc/** | Electron ä¸»è¿›ç¨‹é€šä¿¡ï¼šAI è°ƒç”¨ã€æ–‡ä»¶ç³»ç»Ÿè¯»å†™ã€æ ¼å¼è½¬æ¢ |

---

## Getting Started / å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘ç¯å¢ƒ

```bash
npm run dev
```

### è¿è¡Œæµ‹è¯•

> âš ï¸ **é‡è¦**ï¼šå¼€å‘æ—¶æ”¹åŠ¨æ ¸å¿ƒæ¨¡å—åè¯·å…ˆæ‰§è¡Œ `npm test`

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# å•æ¬¡è¿è¡Œï¼ˆä¸ watchï¼‰
npm run test:run

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### æ„å»º

```bash
npm run build
```

---

## Project Structure / é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ canvas/           # æ¸²æŸ“å±‚ï¼ˆDocumentSurface, EditorContainerï¼‰
â”œâ”€â”€ components/       # UI ç»„ä»¶ï¼ˆToast, Dialog, StatusBarï¼‰
â”œâ”€â”€ config/           # é…ç½®ï¼ˆå­—ä½“ã€æ’ç‰ˆã€åº”ç”¨é…ç½®ï¼‰
â”œâ”€â”€ core/             # æ ¸å¿ƒæœåŠ¡ï¼ˆSaveService, SnapshotServiceï¼‰
â”œâ”€â”€ document/         # æ–‡æ¡£ AST å’Œå¼•æ“
â”œâ”€â”€ docops/           # æ–‡æ¡£æ“ä½œå±‚ï¼ˆDocOps, SectionDocOpsï¼‰
â”œâ”€â”€ format/           # æ ¼å¼è½¬æ¢ï¼ˆLibreOffice é›†æˆï¼‰
â”œâ”€â”€ outline/          # å¤§çº²è§†å›¾
â”œâ”€â”€ ribbon/           # Word é£æ ¼ Ribbon UI
â”œâ”€â”€ runtime/          # AI Runtimeï¼ˆDocAgent, LlmServiceï¼‰
â”‚   â””â”€â”€ docAgent/     # DocAgent Runtimeï¼ˆç¿»è¯‘ã€æ€»ç»“ç­‰ï¼‰
â”œâ”€â”€ store/            # çŠ¶æ€ç®¡ç†ï¼ˆAppContext, RecentDocumentsï¼‰
â”œâ”€â”€ views/            # è§†å›¾ç»„ä»¶
â””â”€â”€ main/             # Electron ä¸»è¿›ç¨‹
    â”œâ”€â”€ docEngine/    # æ–‡æ¡£å¼•æ“ï¼ˆLibreOffice, SimpleDocxï¼‰
    â””â”€â”€ ipc/          # IPC å¤„ç†å™¨
```

---

## Design Principles / è®¾è®¡åŸåˆ™

1. **æœ¬åœ°ä¼˜å…ˆ**ï¼šæ–‡æ¡£å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œéšæ—¶å¯ç”¨æ ‡å‡†å·¥å…·æ‰“å¼€
2. **AST ä¸ºçœŸç›¸**ï¼šæ–‡æ¡£çŠ¶æ€å§‹ç»ˆç”± `DocumentAst` è¡¨ç¤ºï¼Œä¸ç›´æ¥æ“ä½œ DOM
3. **DocOps ä¸ºå”¯ä¸€ä¿®æ”¹æ–¹å¼**ï¼šæ‰€æœ‰ä¿®æ”¹é€šè¿‡ `DocOp` å®Œæˆï¼Œæ”¯æŒ Undo/Redo
4. **é€‰åŒºä¸ä¸¢å¤±**ï¼šé€‰åŒºä¿å­˜åœ¨ React state ä¸­ï¼Œå¼¹çª—/å¤±ç„¦ä¸ä¼šæ‰“æ–­
5. **Liquid Glass**ï¼šéµå¾ª macOS é£æ ¼çš„ç»ç’ƒæè´¨è®¾è®¡ç³»ç»Ÿ
6. **TDD ä¼˜å…ˆ**ï¼šä¿®æ”¹æ ¸å¿ƒé€»è¾‘å‰å…ˆå†™æµ‹è¯•

---

## Roadmap / æœªæ¥è§„åˆ’

### Short-termï¼ˆv0.xï¼‰

**å†™ä½œä½“éªŒï¼š**
- æ›´ç¨³å®šçš„å¤šçº§åˆ—è¡¨ + ç¼©è¿›ç³»ç»Ÿï¼ˆè¡Œä¸ºå¯¹é½ Wordï¼‰
- æ›´å¥½çš„ä¸­æ–‡ / è‹±æ–‡å­—ä½“ä¸è¡Œé—´è·é»˜è®¤æ–¹æ¡ˆ
- ç‰ˆæœ¬å¿«ç…§æµè§ˆä¸å›æ»šé¢æ¿

**AI èƒ½åŠ›ï¼š**
- ã€Œç»§ç»­å†™è¿™ä¸€æ®µã€/ã€Œæ”¹å†™æ•´èŠ‚ä¿æŒç»“æ„ã€
- å¯¹æ¯”ä¸¤ä¸ªå¿«ç…§ï¼Œç”Ÿæˆã€Œå·®å¼‚æ€»ç»“ã€
- Prompt / æ¨¡å‹é…ç½®é¢æ¿ï¼ˆæ”¯æŒåˆ‡æ¢ä¸åŒ LLMï¼‰

### Mid-termï¼ˆv1.xï¼‰

**DocAgent æ’ä»¶åŒ–ï¼š**
- å¯¹å¤–æš´éœ²ä¸€ä¸ªç®€å•çš„ Agent æ’ä»¶æ¥å£ï¼š
  - å®šä¹‰è¾“å…¥ï¼ˆé€‰åŒº / å°èŠ‚ / æ–‡æ¡£ï¼‰
  - å®šä¹‰è¾“å‡ºï¼ˆæ–‡æœ¬ / ç»“æ„åŒ–å‘½ä»¤ï¼‰
- æ”¯æŒç¬¬ä¸‰æ–¹å¼€å‘è€…æ·»åŠ è‡ªå·±çš„ DocAgent

**æ›´ä¸°å¯Œçš„æ–‡æ¡£ç»“æ„æ”¯æŒï¼š**
- å›¾ç‰‡ã€è¡¨æ ¼ã€æ³¨é‡Š / æ‰¹æ³¨ åŸºç¡€èƒ½åŠ›
- æ›´å¤š docx æ ·å¼æ˜ å°„

### Long-termï¼ˆv2.x+ï¼‰

**å¤šæ–‡æ¡£å·¥ä½œæµï¼š**
- è·¨æ–‡æ¡£å¼•ç”¨ã€ç»Ÿä¸€å¤§çº²è§†å›¾

**æ›´æ·±å…¥çš„ AI èƒ½åŠ›ï¼š**
- æ–‡æ¡£ç»“æ„é‡ç»„ã€è‡ªåŠ¨ç”Ÿæˆç›®å½•ã€è‡ªåŠ¨ç”Ÿæˆä¸‹ä¸€ç« èŠ‚å¤§çº²
- åœºæ™¯åŒ– Agentï¼ˆæŠ¥å‘ŠåŠ©æ‰‹ã€è®ºæ–‡åŠ©æ‰‹ã€ä¼šè®®è®°å½•åŠ©æ‰‹ç­‰ï¼‰

---

## Environment Variables / ç¯å¢ƒå˜é‡

```bash
# AI Runtimeï¼ˆOpenRouter å…¼å®¹ï¼‰
OPENROUTER_API_KEY=your-api-key
OPENROUTER_API_ENDPOINT=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_MODEL=google/gemini-2.5-flash-lite
```

---

## Test Coverage / æµ‹è¯•è¦†ç›–

å½“å‰æµ‹è¯•è¦†ç›–çš„æ ¸å¿ƒæ¨¡å—ï¼š

- `src/document/DocumentEngine.ts` - AST æ“ä½œå¼•æ“
- `src/docops/DocOpsEngine.ts` - DocOps ç”Ÿæˆ
- `src/docops/SectionDocOps.ts` - ç« èŠ‚çº§æ“ä½œ
- `src/document/selection.ts` - é€‰åŒºå·¥å…·å‡½æ•°
- `src/outline/outlineUtils.ts` - å¤§çº²ç”Ÿæˆ
- `src/runtime/DocAgent.ts` - AI Agent
- `src/runtime/docAgent/DocAgentRuntime.ts` - Agent Runtime
- `src/core/DocumentSaveService.ts` - è‡ªåŠ¨ä¿å­˜æœåŠ¡

---

## License

MIT
